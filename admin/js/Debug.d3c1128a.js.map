{"version":3,"sources":["webpack:///./src/views/debug/index.vue?0cff","webpack:///./src/views/debug/index.vue?c5dd","webpack:///./src/views/debug/index.vue?0ff0","webpack:///./src/views/debug/index.vue"],"names":["render","_vm","this","_h","$createElement","_c","_self","staticClass","staticStyle","ref","on","onSelectNodeServiceChange","attrs","nodeServices","slice","currpage","pagesize","scopedSlots","_u","key","fn","scope","_v","_s","row","base","node","type","name","addr","minRows","maxRows","model","value","callback","$$v","$set","expression","length","$event","changePageIndex","changePageSize","debugScript","commitDebugCommand","staticRenderFns","component","default_1","arguments","curNodeServices","runAmount","websock","forEach","push","result","tempMap","index","psize","close","baseHost","window","location","host","baseUrl","process","r","match","WebSocket","onmessage","event","Response","data","text","msg","JSON","parse","node_id","Map","set","undefined","get","size","max","tempPrint","k","onopen","targets","stringify","cmd","script","send","Buffer","from","onclose","console","log","onerror","err","message","Vue","__decorate","Component","components","NodeFilter"],"mappings":"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","file":"js/Debug.d3c1128a.js","sourcesContent":["var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"app-container\"},[_c('el-row',{staticStyle:{\"padding-top\":\"15px\",\"padding-bottom\":\"15px\",\"border-bottom\":\"1px solid white\"}},[_c('NodeFilter',{ref:\"nodeFilter\",on:{\"selectNodeServiceChange\":_vm.onSelectNodeServiceChange}})],1),_c('el-row',{staticStyle:{\"padding-top\":\"15px\",\"padding-bottom\":\"15px\",\"border-bottom\":\"1px solid white\"}},[_c('el-table',{staticStyle:{\"width\":\"100%\"},attrs:{\"data\":_vm.nodeServices.slice((_vm.currpage-1)*_vm.pagesize, _vm.currpage*_vm.pagesize),\"stripe\":\"\"}},[_c('el-table-column',{attrs:{\"label\":\"类型\",\"width\":\"100px\"},scopedSlots:_vm._u([{key:\"default\",fn:function(scope){return [_vm._v(\"\\n          \"+_vm._s(scope.row.base.node.type)+\"\\n        \")]}}])}),_c('el-table-column',{attrs:{\"label\":\"节点\",\"width\":\"100px\"},scopedSlots:_vm._u([{key:\"default\",fn:function(scope){return [_vm._v(\"\\n          \"+_vm._s(scope.row.base.node.name)+\"\\n        \")]}}])}),_c('el-table-column',{attrs:{\"label\":\"地址\",\"width\":\"100px\"},scopedSlots:_vm._u([{key:\"default\",fn:function(scope){return [_vm._v(\"\\n          \"+_vm._s(scope.row.base.node.addr)+\"\\n        \")]}}])}),_c('el-table-column',{attrs:{\"label\":\"服务地址\",\"width\":\"100px\"},scopedSlots:_vm._u([{key:\"default\",fn:function(scope){return [_vm._v(\"\\n          \"+_vm._s(scope.row.base.addr)+\"\\n        \")]}}])}),_c('el-table-column',{attrs:{\"label\":\"服务名\",\"width\":\"150px\"},scopedSlots:_vm._u([{key:\"default\",fn:function(scope){return [_vm._v(\"\\n          \"+_vm._s(scope.row.base.name)+\"\\n        \")]}}])}),_c('el-table-column',{attrs:{\"label\":\"结果\",\"height\":\"600px\",\"width\":\"750px\"},scopedSlots:_vm._u([{key:\"default\",fn:function(scope){return [_c('el-input',{attrs:{\"type\":\"textarea\",\"placeholder\":\"执行结果\",\"autosize\":{minRows: 3, maxRows: 3}},model:{value:(scope.row.result),callback:function ($$v) {_vm.$set(scope.row, \"result\", $$v)},expression:\"scope.row.result\"}})]}}])})],1),_c('div',{staticStyle:{\"text-align\":\"center\",\"margin-top\":\"30px\"}},[_c('el-pagination',{attrs:{\"background\":\"\",\"layout\":\"prev, pager, next, sizes, total, jumper\",\"page-sizes\":[5, 10, 15, 20],\"page-size\":_vm.pagesize,\"current-page\":_vm.currpage,\"total\":_vm.nodeServices.length},on:{\"update:pageSize\":function($event){_vm.pagesize=$event},\"update:page-size\":function($event){_vm.pagesize=$event},\"update:currentPage\":function($event){_vm.currpage=$event},\"update:current-page\":function($event){_vm.currpage=$event},\"current-change\":_vm.changePageIndex,\"size-change\":_vm.changePageSize}})],1)],1),_c('el-row',{staticStyle:{\"padding-top\":\"15px\",\"padding-bottom\":\"15px\",\"border-bottom\":\"1px solid white\"}},[_c('el-col',{attrs:{\"md\":24,\"sm\":24}},[_c('el-input',{attrs:{\"autosize\":{minRows: 10, maxRows: 10},\"type\":\"textarea\",\"placeholder\":\"Please input script\",\"min-width\":\"50px\"},model:{value:(_vm.debugScript),callback:function ($$v) {_vm.debugScript=$$v},expression:\"debugScript\"}})],1)],1),_c('el-row',{staticStyle:{\"padding-top\":\"15px\",\"padding-bottom\":\"15px\",\"border-bottom\":\"1px solid white\"}},[_c('el-button',{attrs:{\"type\":\"primary\"},on:{\"click\":function($event){return _vm.commitDebugCommand()}}},[_vm._v(\"执行\")])],1)],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/ts-loader/index.js??ref--13-3!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./index.vue?vue&type=script&lang=ts&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/ts-loader/index.js??ref--13-3!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./index.vue?vue&type=script&lang=ts&\"","import { render, staticRenderFns } from \"./index.vue?vue&type=template&id=765c6906&\"\nimport script from \"./index.vue?vue&type=script&lang=ts&\"\nexport * from \"./index.vue?vue&type=script&lang=ts&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","import { __decorate } from \"tslib\";\nimport { Component, Vue } from 'vue-property-decorator';\nimport NodeFilter from '@/views/nodeFilter.vue';\nlet default_1 = class extends Vue {\n    constructor() {\n        super(...arguments);\n        this.currpage = 1;\n        this.pagesize = 5;\n        this.nodeServices = [];\n        this.curNodeServices = [];\n        this.debugScript = '';\n        this.runAmount = 0;\n        this.websock = null;\n    }\n    onSelectNodeServiceChange(nodeServices) {\n        this.curNodeServices = [];\n        nodeServices.forEach((node) => {\n            this.curNodeServices.push({ base: node, result: '', tempMap: null });\n        });\n        if (this.runAmount === 0) {\n            this.currpage = 1;\n            this.nodeServices = this.curNodeServices;\n        }\n    }\n    changePageIndex(index) {\n        this.currpage = index;\n    }\n    changePageSize(psize) {\n        this.pagesize = psize;\n    }\n    commitDebugCommand() {\n        if (this.websock) {\n            this.websock.close();\n        }\n        let baseHost = window.location.host;\n        let baseUrl = (process.env.VUE_APP_BASE_API || process.env.BASE_URL);\n        if (baseUrl) {\n            let r = baseUrl.match(/http:\\/\\/(.*)\\//);\n            baseHost = (r ? r[1] : baseHost);\n        }\n        this.runAmount++;\n        this.currpage = 1;\n        this.nodeServices = this.curNodeServices;\n        this.websock = new WebSocket('ws://' + baseHost + '/api/debug_run');\n        this.websock.onmessage = async (event) => {\n            let text = await (new Response(event.data)).text();\n            const msg = JSON.parse(text);\n            for (let row of this.nodeServices) {\n                // let row = this.nodeServices[k]\n                if (row.base.node && msg.node_id == row.base.node.addr && msg.addr == row.base.addr) { // eslint-disable-line\n                    if (msg.type === 'error') {\n                        row.result = `${msg.type}: ${msg.msg}\\n`;\n                        row.tempMap = null;\n                    }\n                    else if (msg.type === 'print') {\n                        if (row.tempMap == null) {\n                            row.tempMap = new Map();\n                        }\n                        row.tempMap.set(msg.msg.index, msg.msg.text);\n                        if (row.tempMap.get(0) !== undefined && row.tempMap.size >= msg.msg.max + 1) {\n                            let tempPrint = '';\n                            for (var k = msg.msg.max; k >= 0; --k) {\n                                tempPrint += row.tempMap.get(k);\n                            }\n                            row.result += `${msg.type}: ${tempPrint}\\n`;\n                            row.tempMap = null;\n                        }\n                    }\n                    else {\n                        row.result += `${msg.type}: ${msg.msg}\\n`;\n                    }\n                }\n            }\n        };\n        this.websock.onopen = () => {\n            let targets = [];\n            for (let k in this.nodeServices) {\n                this.nodeServices[k].result = '';\n                targets.push(this.nodeServices[k].base);\n            }\n            let msg = JSON.stringify({ cmd: 'run', script: this.debugScript, targets: targets });\n            this.websock.send(Buffer.from(msg));\n        };\n        this.websock.onclose = () => {\n            console.log(`socket close`);\n        };\n        this.websock.onerror = (err) => {\n            console.log(`socket err: ${err.message}`);\n        };\n    }\n};\ndefault_1 = __decorate([\n    Component({\n        name: 'Debug',\n        components: {\n            NodeFilter\n        }\n    })\n], default_1);\nexport default default_1;\n"],"sourceRoot":""}